{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>AI 配置</h1>
    <div class="config-form">
        <form id="aiConfigForm">
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <input type="password" id="apiKey" name="apiKey" class="form-control">
            </div>
            <div class="form-group">
                <label for="model">模型</label>
                <select id="model" name="model" class="form-control">
                    <option value="deepseek-r1">DeepSeek R1</option>
                    <option value="deepseek-v3" selected>DeepSeek V3</option>
                </select>
            </div>
            <div class="form-group">
                <label for="temperature">温度</label>
                <input type="range" id="temperature" name="temperature" min="0" max="1" step="0.1" value="0.7" class="form-control">
                <span id="temperatureValue">0.7</span>
            </div>
            <button type="submit" class="button primary">保存配置</button>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 加载当前配置
    fetch('/ai/config')
        .then(response => response.json())
        .then(config => {
            document.getElementById('apiKey').value = config.apiKey || '';
            document.getElementById('model').value = config.model || 'deepseek-v3';
            document.getElementById('temperature').value = config.temperature || 0.7;
            document.getElementById('temperatureValue').textContent = config.temperature || 0.7;
        });

    // 温度滑块实时显示
    document.getElementById('temperature').addEventListener('input', function(e) {
        document.getElementById('temperatureValue').textContent = e.target.value;
    });

    // 提交表单
    document.getElementById('aiConfigForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const config = {
            apiKey: document.getElementById('apiKey').value,
            model: document.getElementById('model').value,
            temperature: parseFloat(document.getElementById('temperature').value)
        };

        fetch('/ai/config', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(config)
        })
        .then(response => response.json())
        .then(data => {
            alert('配置已保存');
        })
        .catch(error => {
            alert('保存配置失败：' + error);
        });
    });
});
</script>

<style>
.config-form {
    max-width: 600px;
    margin: 2rem auto;
    padding: 2rem;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 1rem;
}

#temperatureValue {
    margin-left: 1rem;
    color: #666;
}

.button {
    width: 100%;
    padding: 0.75rem;
    font-size: 1rem;
}
</style>
{% endblock %} 